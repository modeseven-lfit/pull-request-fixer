---
# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: 2025 The Linux Foundation

ci:
  skip: [pytest, markdown-table-fixer]
  autofix_commit_msg: |
    Chore: pre-commit autofixes

    Signed-off-by: pre-commit-ci[bot] <pre-commit-ci@users.noreply.github.com>
  autoupdate_commit_msg: |
    Chore: pre-commit autoupdate

    Signed-off-by: pre-commit-ci[bot] <pre-commit-ci@users.noreply.github.com>

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: 3e8a8703264a2f4a69428a0aa4dcb512790b2c8c # frozen: v6.0.0
    hooks:
      - id: trailing-whitespace
      - id: check-added-large-files
      - id: check-ast
      - id: check-json
      - id: check-merge-conflict
      - id: check-xml
      - id: check-yaml
      - id: debug-statements
      - id: end-of-file-fixer
      - id: requirements-txt-fixer
      - id: mixed-line-ending
        args: ["--fix=lf"]
      - id: no-commit-to-branch
        args:
          - --branch=dev
          - --branch=master
          - --branch=main
          - --branch=rc
          - --branch=production

  - repo: https://github.com/jorisroovers/gitlint
    rev: acc9d9de6369b76d22cb4167029d2035e8730b98 # frozen: v0.19.1
    hooks:
      - id: gitlint

  - repo: https://github.com/adrienverge/yamllint.git
    rev: 79a6b2b1392eaf49cdd32ac4f14be1a809bbd8f7 # frozen: v1.37.1
    hooks:
      - id: yamllint
        types: [yaml]

  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: aad66557af3b56ba6d4d69cd1b6cba87cef50cbb  # frozen: v0.14.3
    hooks:
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]
      - id: ruff-format

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: 9f70dc58c23dfcca1b97af99eaeee3140a807c7e # frozen: v1.18.2
    hooks:
      - id: mypy

  - repo: https://github.com/btford/write-good
    rev: ab66ce10136dfad5146e69e70f82a3efac8842c1 # frozen: v1.0.8
    hooks:
      - id: write-good
        files: "\\.(rst|md|markdown|mdown|mkdn)$"
        exclude: |
          (?x)^(
            CHANGELOG\.md|
            IMPLEMENTATION_COMPLETE\.md|
            SETUP\.md|
            FEATURES\.md|
            CONTRIBUTING\.md|
            PROJECT_SUMMARY\.md|
            EMOJI_TESTING\.md|
            examples/bad_tables\.md|
            examples/emoji_tables\.md
          )$

  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: 745eface02aef23e168a8afb6b5737818efbea95 # frozen: v0.11.0.1
    hooks:
      - id: shellcheck

  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: 192ad822316c3a22fb3d3cc8aa6eafa0b8488360 # frozen: v0.45.0
    hooks:
      - id: markdownlint
        args: ["--fix"]

  - repo: https://github.com/fsfe/reuse-tool
    rev: 9fabf9eb815a57aac116b435e8346c200cdb8604  # frozen: v6.2.0
    hooks:
      - id: reuse

  # Check for misspellings in documentation files
  - repo: https://github.com/codespell-project/codespell
    rev: 63c8f8312b7559622c0d82815639671ae42132ac # frozen: v2.4.1
    hooks:
      - id: codespell

  - repo: https://github.com/lfreleng-actions/gha-workflow-linter
    rev: 6e25590048a9b9c49d81656586dd083f47bb4f93  # frozen: v0.1.11
    hooks:
      - id: gha-workflow-linter
        args: [lint, .github/workflows/, --verbose]

  # Markdown table fixer (local development version)
  - repo: local
    hooks:
      - id: markdown-table-fixer
        name: Markdown Table Fixer
        description: Fix markdown table formatting issues
        entry: >-
          bash -c
          'for file in "$@"; do
          markdown-table-fixer lint "$file" --auto-fix || exit 1;
          done' --
        language: system
        files: '\.md$'
        exclude: |
          (?x)^(
            examples/(bad_tables|emoji_tables)\.md|
            EMOJI_TESTING\.md|
            FEATURES\.md|
            IMPLEMENTATION_COMPLETE\.md|
            PROJECT_SUMMARY\.md|
            README\.md|
            scripts/README\.md
          )$
        pass_filenames: true
        require_serial: true

  # Run tests last to ensure all code changes from other hooks are tested
  - repo: local
    hooks:
      - id: pytest
        name: pytest
        entry: uv
        args: [run, pytest, --tb=short, -q]
        language: system
        pass_filenames: false
        always_run: true
